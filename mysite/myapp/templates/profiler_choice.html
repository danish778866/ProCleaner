{% extends 'base.html' %}
{% load staticfiles %}
{% block content %}
<div class="container">
  <div class="page-header" id="banner">
    <div class="row">
      <div class="col-md-12">
        <h1>
          String Profiling and Cleaning Options
        </h1>
        <p class="lead">Please select one of the following options</p>
      </div>
    </div>
  </div>
  <!-- <div class="row">
    <div class="col-md-12">
      <form action="{% url 'show_doc' %}" method="post" enctype="multipart/form-data" class="form-horizontal">
        {% csrf_token %}
        <fieldset>

          <div class="form-group">
            <div class="col-md-4 "></div>
            <div class="col-md-4 ">
              {% for option in profiler_options %}
              <div class="radio">
                <label class="control control--radio">
                  {{ option.1 }}
                  <input type="radio" name="profiler_choice" value="{{ option.0 }}" checked="">

                  <div class="control__indicator"></div>
                </label>
              </div>
              {% endfor %}

            </div>
            <div class="col-md-4 "></div>
          </div>

          <div class="form-group">
            <div class="col-lg-12 text-center">
              <button type="submit" value="Submit" class="btn btn-primary">Execute</button>
            </div>
          </div>
        </fieldset>
      </form>
    </div>
  </div> -->
  <div class="row">
    <div class="col-md-12">
      <form id="formChoices" onsubmit="return validateForm()" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="row">
          <div class="col-md-4 col-md-offset-4">
            {% for option in profiler_options %}
            <b>
            <label class="control control--radio">{{ option.1 }}
              <input type="radio" name="profiler_choice" value="{{ option.0 }}">
              <div class="control__indicator"></div>
            </label>
          </b>
            {% endfor %}
          </div>
        </div>
        
        <br>

        <div class="row">
            <div class="col-md-4 col-md-offset-4">
                <button id="btnSubmit" type="submit" value="Submit" class="btn btn-primary">Execute</button>
                <button type="button" value="backUpload" id="backtouploadbtn" class="btn btn-default">Back to Upload Page</button>
          </div>
        </div>
        <div class="row">
            <div class="col-md-4 col-md-offset-4">
              <br>
                <div class="alert alert-dismissible alert-danger" style="display: none">
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                    <strong>Error: Please select a choice</strong>
                  </div>
                </div>
              </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
{% block script %}
function validateForm() {
  var choice = $("input[name='profiler_choice']:checked").val();
  if(choice === undefined) {
    $(".alert").show();
    return false;
  } else {
    var choice_num = parseInt(choice, 10) - 1;
    var views = ["{% url 'clean_strings' %}", "{% url 'show_doc' %}", "{% url 'show_doc' %}"];
    $("#formChoices").attr('action', views[choice_num]);
    console.log(views[choice_num]);
    return true;
  }
} 
$(document).ready(function(){

  

  $("#backtouploadbtn").click(function(){
    document.location.href = "{% url 'upload' %}";
  });
  /*console.log("Lets go!");
  $("#formChoices").submit(function(event){
    event.preventDefault();
    var choice = $("input[name='profiler_choice']:checked").val();
    if(choice === undefined) {
      $("#errorMessage").html("Please select a choice...");
      $("#errorMessage").css("color", "red");
    } else {
      var form = $("#formChoices");
      var actionUrl = form.attr('action');
      var data = new FormData();
      data.append('profiler_choice', choice);
      console.log(data);
      $("btnSubmit").prop("disabled", true);
      $.ajax({
        type: "POST",
        enctype: 'multipart/form-data',
        url: actionUrl,
        data: data,
        processData: false,
        contentType: false,
        success: function(data) {
          console.log(data);
        }
      });
    }
  });*/
});

{% endblock %}
